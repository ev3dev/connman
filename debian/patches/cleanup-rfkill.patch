Description: <short summary of the patch>
 TODO: Put a short summary on the line above and replace this paragraph
 with a longer explanation of this change. Complete the meta-information
 with other relevant fields (see below for details). To make it easier, the
 information below has been extracted from the changelog. Adjust it or drop
 it.
 .
 connman (1.26-0ev3dev1) testing; urgency=medium
 .
   * New upstream release.
     * Fix issue with missing WiFi security provisioning support.
     * Fix issue with immutable setting and provisioned services.
     * Fix issue with scheduling DNS cache cleanup procedure.
     * Fix issue with IPv6 Privacy setting on service removal.
     * Fix issue with DHCPv6 CONFIRM message sending procedure.
     * Fix issue with DHCPv6 lease expiration handling support.
     * Fix issue with DHCPv4 networks and broadcast flag handling.
     * Fix issue with DHCPv4 networks without gateway configuration.
     * Fix issue with P2P Peer authorization handling.
     * Fix issue with P2P Peer service registration.
     * Add support for WiFi Display information elements.
     * Add support for systemd-hostnamed integration.
Author: David Lechner <david@lechnology.com>

---
The information above should follow the Patch Tagging Guidelines, please
checkout http://dep.debian.net/deps/dep3/ to learn about the format. Here
are templates for supplementary fields that you might want to add:

Origin: <vendor|upstream|other>, <url of original patch>
Bug: <url in upstream bugtracker>
Bug-Debian: http://bugs.debian.org/<bugnumber>
Bug-Ubuntu: https://launchpad.net/bugs/<bugnumber>
Forwarded: <no|not-needed|url proving that it has been forwarded>
Reviewed-By: <name and email of someone who approved the patch>
Last-Update: <YYYY-MM-DD>

--- a/src/technology.c
+++ b/src/technology.c
@@ -1776,6 +1776,21 @@
 	return 0;
 }
 
+gboolean find_first(gpointer key, gpointer value, gpointer user_data)
+{
+	return TRUE;
+}
+
+void __connman_technology_cleanup_rfkill(void)
+{
+	struct connman_rfkill *rfkill;
+
+	DBG("");
+
+	while (rfkill = g_hash_table_find(rfkill_list, find_first, NULL))
+		__connman_technology_remove_rfkill(rfkill->index, rfkill->type);
+}
+
 int __connman_technology_init(void)
 {
 	DBG("");
--- a/src/connman.h
+++ b/src/connman.h
@@ -826,6 +826,7 @@
 
 #include <connman/notifier.h>
 
+void __connman_technology_cleanup_rfkill(void);
 int __connman_technology_init(void);
 void __connman_technology_cleanup(void);
 
--- a/src/rfkill.c
+++ b/src/rfkill.c
@@ -232,4 +232,6 @@
 	g_io_channel_unref(channel);
 
 	channel = NULL;
+
+	__connman_technology_cleanup_rfkill();
 }
